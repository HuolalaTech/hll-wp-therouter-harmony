"use strict";var __importDefault=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.LogPathUtil=void 0;const path_1=__importDefault(require("path")),process_1=__importDefault(require("process")),HvigorLoggerConfig_js_1=require("./HvigorLoggerConfig.js"),HvigorLogInfo_js_1=require("../logger/HvigorLogInfo.js"),ErrorLogConsts_js_1=require("../consts/ErrorLogConsts.js");class LogPathUtil{static logFilePath(){let o;try{o=LogPathUtil.getHvigorCacheDir()}catch{o=path_1.default.resolve(LogPathUtil.HVIGOR_PROJECT_ROOT_DIR,LogPathUtil.HVIGOR_USER_HOME_DIR_NAME)}return path_1.default.resolve(o,"./outputs/build-logs")}static getHvigorCacheDir(o){var e;let r=void 0!==process_1.default.env.config?JSON.parse(process_1.default.env.config)[ErrorLogConsts_js_1.BUILD_CACHE_DIR]:null!==(e=HvigorLoggerConfig_js_1.HvigorLoggerConfig.getExtraConfig(ErrorLogConsts_js_1.BUILD_CACHE_DIR))&&void 0!==e?e:LogPathUtil.getCommandHvigorCacheDir();const t=path_1.default.resolve(LogPathUtil.HVIGOR_PROJECT_ROOT_DIR,LogPathUtil.HVIGOR_USER_HOME_DIR_NAME);return r||(r=HvigorLoggerConfig_js_1.HvigorLoggerConfig.getHvigorCacheDir(),r)?path_1.default.isAbsolute(r)?(o&&!this.hvigorCacheDirHasLogged&&(o.warn((new HvigorLogInfo_js_1.HvigorLogInfo).setLogLevel(ErrorLogConsts_js_1.LogLevel.WARN).setMessage("Please ensure no projects of the same name have the same custom hvigor data dir.")),this.hvigorCacheDirHasLogged=!0),path_1.default.resolve(r,path_1.default.basename(process_1.default.cwd()),ErrorLogConsts_js_1.HVIGOR_USER_HOME_DIR_NAME)):(o&&!this.hvigorCacheDirHasLogged&&(o.warn((new HvigorLogInfo_js_1.HvigorLogInfo).setLogLevel(ErrorLogConsts_js_1.LogLevel.WARN).setMessage(`Invalid custom hvigor data dir:${r}`)),this.hvigorCacheDirHasLogged=!0),t):t}static getCommandHvigorCacheDir(){return process_1.default.argv.forEach(o=>{o.startsWith(ErrorLogConsts_js_1.BUILD_CACHE_DIR)&&(process_1.default.env.BUILD_CACHE_DIR=o.substring(o.indexOf("=")+1))}),process_1.default.env.BUILD_CACHE_DIR}}exports.LogPathUtil=LogPathUtil,LogPathUtil.HVIGOR_PROJECT_ROOT_DIR=process_1.default.cwd(),LogPathUtil.HVIGOR_USER_HOME_DIR_NAME=".hvigor",LogPathUtil.hvigorCacheDirHasLogged=!1;